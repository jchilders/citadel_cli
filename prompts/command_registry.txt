Let's talk about refactoring Citadel so that it uses a proper command registry pattern for managing commands. The structure of the Command, CommandItem, and CommandArg interfaces are allowed change (be renamed, removed, or otherwise altered as necessary). 

There are two hard requirements of the refactor I can think of:

1. The command registry should work with the existing@commands-config.ts. I.e.: no changes should be made to that file, except perhaps changing `CommandConfig` to something that makes more sense.
2. Entering, displaying, and completing commands should behave exactly the same as it does now. This is of critical importance, so take your time here. Specifically, the registry should be able to handle:
- Commands with zero or more arguments
- Commands with zero or more subcommands


